 ## 这是一次艰难的经历，开始都很简单，但后续却发生很多问题
 
 - 功能介绍
     1. 要搜索拥有某一种资源最多的玩家，然后发邮件告知目标玩家的名称和坐标
     2. 条件有，大本等、战力、是否是同一个联盟、资源种类、不能与与保护罩、不能跨服、不能集团隐藏效果(gameEffect) (这三个效果艰难了)。
 - 过程
    1. 一开始，是使用道具，而且每天重置次数。建了数据库表
    2. 然后就是sql了，刚开始，我是用各种left join，然后执行比较慢。当时不以为然，觉得复杂的sql就应该这么长时间。
       后来果然被骂了，太烂。重新写。而且执行时间要在一秒内。
       1. 要求直接主键关联，发现确实快了许多。
       2. 不要关联大表，比如worldPoint, 表确实太大了，而且很慢。就算是主键也不行。
       3. 发现 > 、 <> 、 is null 并没有很影响速度
       4. 到最好发现，最慢的还是 排序
  - 难点
    1. 只查询一个玩家，还要判断这个不能是自己。这个怎么做
       不可能在加一个不等于判断，影响速度，可以查出两个玩家，再逻辑判断就可以了
    2. 玩家主城，有buff效果，可以隐藏。而且这个效果和大地图是分隔的。如何查。
     - 这个确实很麻烦，怎么查。当时解决方法有两个，一个是连表查，然后查询出没有该效果的点。但这个表数据是模糊的，在这个表的点不一定有这个效果，会筛出一部分有效玩家。
     - 另一个是先查出20个玩家，再一个一个判断，玩家是否有这个效果。刚好有这个效果的玩家并不是很多，还可以承受。后来就选了后一个方案。
        
    3、玩家主城点可能被清除，需要判断。数据里可能有无效数据，需要排除。
     -  这个最初是没有好的方法的，因为连worldPoint表，太大了。无法做。
     - 后来worldPoint表做缓存了，都放入map里了。这个时候可以参考2方法，用逻辑来处理。更快一点